<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bridge &mdash; Apollo Auto alpha documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/cyber/doxy-docs/source/main_stylesheet.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Vehicle Calibration Configs" href="../calibration/data/README.html" />
    <link rel="prev" title="Dump audio to wave" href="../audio/tools/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: skyblue" >
            <a href="../../index.html" class="icon icon-home"> Apollo Auto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Apollo Auto 自述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/README.html">Apollo Auto 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cyber/doxy-docs/source/index.html">cyber 文档</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: skyblue" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apollo Auto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Bridge</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/modules/bridge/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="bridge">
<h1>Bridge<a class="headerlink" href="#bridge" title="Permalink to this headline"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>This module provides a way for other Apollo modules interactiving with process
outside of Apollo by socket. It includes sender and receiver components.</p>
</section>
<section id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline"></a></h2>
<p>In sender component, there is only one input, which is the proto struct sender
handled. In receiver comonent, its input is different with others. Its input
comes from UDP socket.</p>
</section>
<section id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline"></a></h2>
<p>Sender’s output is by way of UDP socket. Receiver has one output which is
receiver handled.</p>
</section>
<section id="launch">
<h2>Launch<a class="headerlink" href="#launch" title="Permalink to this headline"></a></h2>
<p>The startup of Bridge is consistent with the startup of other modules. Bridge
contains two sub-modules, other than: sender and receiver. The sender is
responsible for sending the udp data, and the receiver is responsible for
receiving the data packet sent by the udp client, and parsing it, and then
sending it to the module that has registered to respond to the message. The
start command of Sender is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cyber_launch start /apollo/modules/bridge/launch/bridge_receiver.launch
</pre></div>
</div>
<p>The start command of Receiver is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cyber_launch start /apollo/modules/bridge/launch/bridge_sender.launch
</pre></div>
</div>
</section>
<section id="modify-the-configuration">
<h2>modify the configuration<a class="headerlink" href="#modify-the-configuration" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Receiver listens to port 8900 by default, and can change the port number to be
monitored by modifying its corresponding configuration file. The corresponding
configuration file can be queried in the dag file, as shown in the following
figure. <img alt="" src="../../_images/Picture1.png" /></p></li>
</ul>
<p>Its configuration file:
/Apollo/modules/bridge/conf/udp_bridge_receiver_chassis.pb.txt</p>
<p><img alt="" src="../../_images/Picture2.png" /></p>
<p>Note: If you want to receive data from the client outside the docker, you need
to do port mapping with the -p parameter when starting docker, you need to
modify the docker/scripts/dev_start.sh file, as shown below.
<img alt="" src="../../_images/Picture3.png" /></p>
<p>Add a new line -p 8900:8900 after -d . This allows you to map the internal and
external ports of docker, and you can accept the data sent by the external
client of docker.</p>
<ul class="simple">
<li><p>The sender configuration file is searched in the same way as the receiver. The
sender that sends the ADCTrajectory is sent to 127.0.0.1:8900 by default; the
sender that sends the LocalizationEstimate is sent to 127.0.0.1:8901 by
default. The above ip address and port number can be modified through the
corresponding configuration file. The configuration file information is as
shown below. <img alt="" src="../../_images/Picture4.png" /></p></li>
</ul>
</section>
<section id="add-new-message">
<h2>Add new message<a class="headerlink" href="#add-new-message" title="Permalink to this headline"></a></h2>
<p>To send/receive new messages via udp, you can add two lines of code to the
corresponding file. If you want to add the message apollo::test::PbTest, as
shown below. <img alt="" src="../../_images/Picture5.png" /> Add a new line after the 80th line of this
file udp_bridge_receiver_component.h:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RECEIVER_BRIDGE_COMPONENT_REGISTER</span><span class="p">(</span><span class="n">test</span><span class="p">::</span><span class="n">PbTest</span><span class="p">)</span>
</pre></div>
</div>
<p>Also add after 197 lines of udp_bridge_receiver_component.cc</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BRIDGE_RECV_IMPL</span><span class="p">(</span><span class="n">test</span><span class="p">::</span><span class="n">PbTest</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../../_images/Picture6.png" /> The addition of Sender is consistent with the receiver.
After the code is modified, save it, then add the corresponding configuration
file, startup file, and dag file. Recompile the code and start it.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../audio/tools/README.html" class="btn btn-neutral float-left" title="Dump audio to wave" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../calibration/data/README.html" class="btn btn-neutral float-right" title="Vehicle Calibration Configs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, xinetzone.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>