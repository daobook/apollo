<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bridge Header Protocol &mdash; Apollo Auto alpha 文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/cyber/doxy-docs/source/main_stylesheet.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script src="../../_static/translations.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Apollo坐标系统" href="coordination_cn.html" />
    <link rel="prev" title="Bazel in Apollo" href="bazel_in_apollo_an_overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: skyblue" >
            <a href="../../index.html" class="icon icon-home"> Apollo Auto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Apollo Auto 自述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Apollo Auto 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cyber/doxy-docs/source/index.html">cyber 文档</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: skyblue" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Apollo Auto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Bridge Header Protocol</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/specs/bridge_header_protocol.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="bridge-header-protocol">
<h1>Bridge Header Protocol<a class="headerlink" href="#bridge-header-protocol" title="永久链接至标题"></a></h1>
<p>This document describes the details about bridge header protocol.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="永久链接至标题"></a></h2>
<p>Bridge is responsible for forwarding the proto message specified in Apollo to
the external module in UDP mode, and receiving the proto message from the
external module. Due to the limitation of the UDP packet (the maximum packet
size is 65535 bytes), the proto message exceeds this limit after serialization.
It is possible, so the serialized packets need to be fragmented, and each slice
is called a frame. The receiver receives all the frames and then combines and
deserializes them. In order to conveniently distinguish each frame of data, to
facilitate subsequent combination and deserialization, it is necessary to add
frame header information at the head of each frame of data, as shown in the
following figure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">+-----+------------+------------+-------+-----------+</span>
    <span class="o">|</span><span class="n">Flag</span> <span class="o">|</span><span class="n">Header</span> <span class="n">Size</span> <span class="o">|</span><span class="n">Header</span> <span class="n">Item</span> <span class="o">|...</span> <span class="o">...|</span><span class="n">Header</span> <span class="n">Item</span><span class="o">|</span>
    <span class="o">+-----+------------+------------+-------+-----------+</span>
</pre></div>
</div>
<p>As shown in the figure above, the Header consists of three segments: Flag, Size,
and Items, where the segment is separated by ‘\n’. Flag: The sign of this
agreement, currently a string “ApolloBridgeHeader”; Size: the length of the
entire Items section (unit: byte) Items: The specific content of the header,
where each item has three components, each of which is divided by ‘:’. The
specific schematic is shown in the figure below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">+----------+----------+-------------+</span>
    <span class="o">|</span><span class="n">Item</span> <span class="n">Type</span> <span class="o">|</span><span class="n">Item</span> <span class="n">Size</span> <span class="o">|</span> <span class="n">Item</span> <span class="n">Content</span><span class="o">|</span>
    <span class="o">+----------+----------+-------------+</span>
</pre></div>
</div>
<p>The Item Type is defined as follows:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Enum</span><span class="w"> </span><span class="n">HType</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="n">Header_Ver</span><span class="p">,</span><span class="w"> </span><span class="c1">// header version number, type: uint32_t</span>
<span class="n">Msg_Name</span><span class="p">,</span><span class="w">   </span><span class="c1">// proto name, such as Chassis, type: std::string</span>
<span class="n">Msg_ID</span><span class="p">,</span><span class="w">     </span><span class="c1">// sequence num of proto, guaranteed unique value in the same proto, type: uint32_t</span>
<span class="n">Msg_Size</span><span class="p">,</span><span class="w">   </span><span class="c1">// the size of the proto serialized, type: size_t</span>
<span class="n">Msg_Frames</span><span class="p">,</span><span class="w"> </span><span class="c1">// how many frames are proto serialized, type: uint32_t</span>
<span class="n">Frame_Size</span><span class="p">,</span><span class="w"> </span><span class="c1">// the size of the current frame, type: size_t</span>
<span class="n">Frame_Pos</span><span class="w">   </span><span class="c1">// The offset of the current frame in the meta-serialized buf, type: size_t</span>
<span class="n">Frame_Index</span><span class="p">,</span><span class="c1">// The sequence number of the current frame in the total number of frames, starting from 0, type: uint32_t</span>
<span class="n">Time_Stamp</span><span class="p">,</span><span class="w"> </span><span class="c1">// timestamp, type: double</span>
<span class="n">Header_Tail</span><span class="p">,</span><span class="c1">// indicates the maximum value of the currently supported Type, always at the end of the enum</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bazel_in_apollo_an_overview.html" class="btn btn-neutral float-left" title="Bazel in Apollo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="coordination_cn.html" class="btn btn-neutral float-right" title="Apollo坐标系统" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2021, xinetzone.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>